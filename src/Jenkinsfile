pipeline {
  agent any

  environment {
    // Optional: Customize Node and Angular CLI versions
    PATH = "/usr/local/bin:$PATH"
  }

  stages {
    stage('Clone Repository') {
      steps {
        echo 'ğŸ“¥ Cloning Angular project...'
        git 'https://github.com/Mohankumar09/SalonSpa.git'
      }
    }

    stage('Install Dependencies') {
      steps {
        echo 'ğŸ“¦ Installing npm dependencies...'
        sh 'npm install'
      }
    }

    stage('Build Angular App') {
      steps {
        echo 'ğŸ—ï¸ Building the Angular project...'
        sh 'npx ng build --configuration=production'
      }
    }

    stage('Run Tests') {
      steps {
        echo 'ğŸ§ª Running tests...'
        sh 'npx ng test --watch=false --browsers=ChromeHeadless || true'
      }
    }

    stage('Archive Build') {
      steps {
        echo 'ğŸ—‚ï¸ Archiving the dist folder...'
        archiveArtifacts artifacts: 'dist/**', allowEmptyArchive: true
      }
    }
  }

  post {
    success {
      echo 'âœ… Angular pipeline completed successfully!'
    }
    failure {
      echo 'âŒ Angular pipeline failed!'
    }
  }
}
