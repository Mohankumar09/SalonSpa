pipeline {
  agent any

  environment {
    // Optional: Customize Node and Angular CLI versions
    PATH = "/usr/local/bin:$PATH"
  }

  stages {
    stage('Clone Repository') {
      steps {
        echo '📥 Cloning Angular project...'
        git 'https://github.com/Mohankumar09/SalonSpa.git'
      }
    }

    stage('Install Dependencies') {
      steps {
        echo '📦 Installing npm dependencies...'
        sh 'npm install'
      }
    }

    stage('Build Angular App') {
      steps {
        echo '🏗️ Building the Angular project...'
        sh 'npx ng build --configuration=production'
      }
    }

    stage('Run Tests') {
      steps {
        echo '🧪 Running tests...'
        sh 'npx ng test --watch=false --browsers=ChromeHeadless || true'
      }
    }

    stage('Archive Build') {
      steps {
        echo '🗂️ Archiving the dist folder...'
        archiveArtifacts artifacts: 'dist/**', allowEmptyArchive: true
      }
    }
  }

  post {
    success {
      echo '✅ Angular pipeline completed successfully!'
    }
    failure {
      echo '❌ Angular pipeline failed!'
    }
  }
}
