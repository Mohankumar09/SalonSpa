pipeline {
  agent any

  environment {
    // Optional: Customize Node and Angular CLI versions
    PATH = "/usr/local/bin:$PATH"
  }

  stages {
    stage('Clone Repository') {
      steps {
        echo 'ğŸ“¥ Cloning Angular project...'
        git branch: 'main', url: 'https://github.com/Mohankumar09/SalonSpa.git'

      }
    }

    stage('Install Dependencies') {
      steps {
        echo 'ğŸ“¦ Installing npm dependencies...'
        bat 'npm install'
      }
    }

    stage('Build Angular App') {
      steps {
        echo 'ğŸ—ï¸ Building the Angular project...'
        bat 'npx ng build --configuration=production'
      }
    }

    stage('Run Tests') {
      steps {
        echo 'ğŸ§ª Running tests...'
        bat 'npx ng test --watch=false --browsers=ChromeHeadless || exit 0'
      }
    }

    stage('Archive Build') {
      steps {
        echo 'ğŸ—‚ï¸ Archiving the dist folder...'
        archiveArtifacts artifacts: 'dist/**', allowEmptyArchive: true
      }
    }

    stage('Simulate Deployment') {
      steps {
        echo 'ğŸš€ Simulating deployment to local folder...'
        bat 'xcopy /E /I /Y dist\\netroot "C:\\my-deployment-folder"'
      }
    }
  }

  post {
    success {
      echo 'âœ… Angular pipeline completed successfully!'
    }
    failure {
      echo 'âŒ Angular pipeline failed!'
    }
  }
}
